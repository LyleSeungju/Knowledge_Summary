# 클라우드 개론

#### 클라우드 공부한다면 가장 먼저 떠오르는 것들?
- 간단한 풀스택 공부 
- AWS, GCP 같은 클라우드 서비스 공부
- Docker 실습
- Jenkins 등 자동 배포 실습

#### 그 전에 배워야 할 것들
- 클라우드 개념 > 인터넷 상에서 여러 리소스를 내가 원할 때마다 만큼 제공한다는 뜻

#### 리소스를 제공한다는 것이 뭘까?
1. 리소스 그대로 통째로 빌려주는 방법
	- 내가 원하는 스펙에 딱 맞추기 힘들다.
	- 요구사항에 맞추는 서버를 때마다 만드는건 난이도가 높다.
2. 큰 서버에서 사용자가 원하는 만큼의 서버롤 또 띄우기
	- 좋은 스펙에서 조금 떼다가 새로운 서버를 만듦
	- "가상화"

#### 가상화 개념
- 가상화란? 물리적인 자원을 추상화하여 가상 자원을 만들어 관리하는 기술
서버 가상화하는 방법
1. 호스트 가상화 - Virtual Box, VMware
	- OS를 띄우고 가상화 소프트웨어를 띄운 뒤 게스트 OS를 띄움
	- 가상화 소프트웨어
	- 게스트OS
2. **하이퍼바이저 가상화 - Xen, KVM** >> 이걸 클라우드 엔지어는 주로 씀
	- 하이퍼바이저에서 부팅시키고 그 위에 OS 얹는다
	- OS의 명령어를 하이퍼바이저가 모두 받아들이거나(Para-virtualization, PV)
	- 하드웨어에서 OS명령어를 이해하는 경우(Hardware Virtual Machine, HVM)
3. 컨테이너 가상화 - Linux container, Docker
	- 미들웨어를 통해 관리함

#### AWS에서는 어떤 가상화 개념을 사용하고 있을까?
- aws ec2는 초반에는 pv 사용하다가 주로 hvm 방식을 사용하고 있고, 최근에는 nitro system 사용
- https://aws.amazon.com/ko/ec2/nitro/
- 컨테이너 가상화도 많이 씀

#### 가상화 종류
- **서버 가상화**
- 데스크탑 가상화 - remote / 원격 공유 
- 애플리케이션 가상화 - 핸드폰 띄우는 것
- 네트워크 가상화 - 컨테이너 레벨에서 많이 씀 / 하나의 네트워크를 여러 네트워크로 나눔
- 스토리지 가상화

#### Vitual Machine vs. Bare Metal
- VM
	- 가상 머신. 가상화 방식(PV / HVM)기반으로 생성된 서버 
	- 대부분의 클라우드 서버
	- 하이퍼바이저 위에 여러 vm이 있기때문에 한쪽의 서버가 리소스를 많이 잡아먹는다면 다른 서버에 영향을 줌
- Bare metal
	- 서버 통째로 빌려주기 제공
	- vm보다 성능이 좋음 >> 하이퍼바이저 독식 할 수 있음

#### CPU vs vCPU
- CPU
	- 베어메탈에서는 실제 이걸 씀
	- 실제 하드웨어 자원
- vCPU : 클라우드에서는 주로 이 단어를 씀
	- **가상화 환경에서 물리적 cpu를 추상화하여 지원**
	- vm에 할당된 가상 자원

#### 가상화 기술 기반의 비즈니스
- 클라우드 서비스 aws, gcp, kakao cloud
	- 각종 자원들을 가상화하여 서비스
	- 서버, 네트워크, 스토리지 가상화
- 플랫폼 기반 서비스
	- 이미 서버는 준비되어있고 거기에 애플리케이션만 올려서 사용
	- 가상화된 자원을 자동으로 할당 받아 애플리케이션 실행
- 솔루션 기반 서비스
	- 사용자의 니즈가 반영된 애플리케이션이 가상화된 자원을 할당받아 곧바로 서비스가 제공
	- 사용자는 곧바로 서비스를 이용

#### Iaas  Infrastructure as a Service
- 보통의 클라우드 서비스
- Cloud Service Provider로 불리기도 함
- AWS / GCP / Kakao Cloud
- +**여기 기술스택에서의 미들웨어는 어떤 것을 뜻하는걸까?**
	- 

#### Paas 
- Platform as a Service
- 본인의 애플리케이션을 업로드하여 서비스로 활용
- Heroku/ Vercel / Netlify

#### SaaS
- Software as a Service
- 사용자는 곧바로 서비스 이용 / 클라우드 기반이기에 사용량에 따른 과금 정책
- 대부분의 서비스

#### 우리가 집중적으로 이해해야 부분은 IaaS / SaaS 
- 대부분의 기업은 IaaS / SaaS
	- IaaS는 만드는 것이 쉽지 않음 / 기본적으로 큰 데이터 센터를 가지고 있어야함(카카오, 네이버)
	- 대부분 클라우드 엔지니어는 IaaS를 다루어 SaaS를 개발함.
- 클라우드 시장
	- IaaS 는 aws가 가장 많이 사용
- IaaS를 만든다는 뜻
	- openStack을 사용
	- c/c++/python 공부해야함

#### IaaS 서비스 들의 기본 기능들
- Compute
- Network
- Storage
- Container
- Database
- Security
- AI
- etc.  

#### 클라우드 서비스의 이런 많은 기능을 어떻게 사용해야 할까?
자주 사용하는 기능
- Network / Compute / Database / Storage 에 조금씩 더해감
- Network에서 리전(지역) 정하기 - 물리적인 서버 위치 정하기 > 네트워크 구조 세팅 
	- 직접 네트워크를 어떻게 관리하면 되는지?
	- 네트워크를 자르는 방법 - 규칙은 있는데 자르는 단위는 애플리케이션 기준으로 해야함 
- 세팅된 네트워크 위에 서버를 올림 
- 데이터베이스를 애플리케이션에 붙이고
- 저장소를 이용하여 로그같은 것을 붙이고

그 외의 기능들
- Security 보안 강화
- AI 서비스
- 그 외 

보통 회사는 it컨설팅 팀이 있는데, 고객에게 우리가 이런 서비스가 있으니 이렇게 써봐라 하기도 함
- 엔지니어쪽도 중요하지만 고객관리하는(영업) 측면으로도 가능함

아래부터 어려워짐 
#### 클라우드 아키텍처
: 서비스를 구축 할때, 클라우드 서비스의 다양한 기능들을 이용하여 인프라 구축 그림을 그리는 것

#### 클라우드 아키텍처를 그리기 위한 배경 지식들
- OS
	- 자주 사용하는 서버는 우분투 
	- 애플리케이션이 실행 가능한 os 내에서 가장 **최적화**된 os를 선택하는 것도 중요
	- + **다양한 os를 알고 비교할 줄 알아야 겠다.** 
- 네트워크
	- 기본 클라우드 내 네크워크 세팅
		- Region 선택 (지역)
		- VPC (virtual private cloud) 만듦 > 네트워크 가상화 : 내부 ip를 만들어주는 역할
			- 우리 서버끼리의 통신이 가능하게 하는 네트워크 통신 어쩌구 
			- 공유기를 통해 wifi, 랜선으로 접속한 컴퓨터들은 내부 통신망을 구성하게 됨
			- 이것을 통해 우리만의 네트워크 가상화가 생성된다
		- subnet을 통해 가상 네트워크 공간을 ip 기준으로 논리적으로 나눔
			- + 이 지식도 좀 더 알아보자
	- 네트워크 배경지식
		- L4 / L7 많이 활용(OSI 계층)
		- VPC, subnet 
		- protocol
		- ip, port

- 파일시스템
	- 흔히 ssd, hhd 비슷
	- 클라우드에서도 서버 용량 붙일때 hhd, ssd 선택 
	- 특이사항: 파일시스템을 붙일때 network block으로 만들어 붙임
	- 실제 파일시스템과 성능 다를 수 있음: input / output , read/write  > 클라우드에서 사용하는 것들은 인터넷을 이용하기 때문
	- NFS(network file system), NBD(network block device)
- VM
	- 가상화된 서버
	- 보통 onDemand 형태로 필요한 만큼 사용하거나 / 1년이나 3년 비용을 미리 할인된 가격으로 내는 Reserved 방식으로 활용
		- reserved 형식으로 미리 예측하여 미리 내는 것을 통해 비용을 줄이는 것도 클라우드 엔지니어의 주 역할
	- spot instance 형태로 최대 70퍼 할인된 가격으로 사용도 가능
		- 어떤 리소스가 남을때 잠깐 빌려주는 형태
		- 계속 지속적인 것이 아니라 회수될 수 있기에 잠깐 테스트 해보는 형식으로 하는게 좋음
- LB (Load Balancer)
	- 네트워크 트래픽을 분산시키는 역할 
	- 안정성과 가용성 / 서버를 이중화 할때 가장 많이 사용 > 죽은 서버에 트래픽을 보내지 않게됨
	- health -check기능을 통해 서버가 살아있는지 확인 후 살아 있는 서버에 트래픽 보냄
		- 트래픽을 몰리는 곳에서 안몰리는 쪽으로 트래픽을 돌려 보냄
	- 얘도 만능이 아님, 느려질 수 있음
	- 트래픽을 몰릴 것을 예상할때는 서버도 늘리지만 미리 부하를 줘서 lb를 구성하는 서버도 미리 늘려놓는 걸 pre-warming / warm-up 이라고 부릅니다.
	- 다만 모든 환경에 로드밸런스가 있진 않다
		- HAProxy와 같은 간단한 LB 만듦
		- LB 의 중요한 기능인 헬스체크를 해서, 살아있는 서버로 트래픽을 보내는 기능이 가장 중요
- Database
	- 애플리케이션의 데이터를 저장하고 관리하는 서비스
	- 라이선스 규정에 의해, 대체적으로 비슷한 기능을 제공하게끔도 함(ex. mongodb == dynamoDB 비스무리)
	- 직접 오픈소스를 운영하는 곳도 있음(amazon rds for mySQL, elasticache)
	- aws 는 거의 최신이지만, 많은 클라우드 서비스들이 오픈소스 버젼업을 유지보수 안할수도 있다
	- 반드시 애플리케이션의 버젼과 데이터 베이스의 버젼을 비교하고 확인해야함
- CDN (Content Delivery Network)
	- 캐싱 서비스
	- 서버에서 리소스를 제공하는데, 만약 사용자가 많아졌을때(트래픽이 몰릴때) ex. 이미지같은거 를 CDN에 올리고 이게 대신 책임져 준다면 서버의 부담이 낮아짐 
	- 비용적으로 비교해볼 필요가 있음 > 서버에서 모든 리소스가 딜리버리된다면 바뀌지 않는 데이터라면 CDN을 비교해보는 것도 좋다. 
- MSA(Micro service architecture)
	- 애플리케이션들을 작은 독립적인 서비스로 분할하여 운영
	- ex결제시스템 - 유저 시스템

#### 클라우드 아키텍처를 쉽게 그리는 법은 없을까?
- 다층구조 Multi-tier Architecture 
	- 프레젠테이션 계층(=프론트엔드 계층) / 애플리케이션 계층(=백엔드 계층) /  데이터 계층(=데이터베이스 계층)으로 나뉨 

- 1티어 구조 1 tier archi
	- vm이 1대있는데 거기에 프론트 서버, 백엔드 서버, 데이터베이스 서버가 있음 
	- 안정성, 효율성 면에서는 초반에는 사용자가 적을때 많이 사용하기도 함
	- 대신. 서버가 죽으면 한번에 댕강이지만, 살리면 한번에 살리게 됨

- 2티어 구조 2 tier archi
	- 프론드, 백엔드 서버 구별 없고 / 데이터베이스와 연결된 상황
	- 현실적으로 이 아키텍쳐를 많이 씀. > 유저 트래픽이 조금은 나오는데 엄청 나오진 않아서 안정성, 서버 종류가 많지 않아 용이
	- 단점. 백엔드에 에러가 나서 장애가 난다면 프론트엔드도 함께 장애가 일어난다.

- 3티어 구조 3 tier archi
	- 프론트엔드 서버 / 백엔드 서버 / 데이터베이스 서버
	- 안정성과 효율성을 따져봐야 한다. 관리도 3배 비용도 3배
	- 인프라 운영에 노하우가 있고, 제품에 이해하고 있는 상황이라면 가장 나은 방식
	- 최종장

- N티어 구조 N tier archi 
	- 프론트도 여러개 백엔드도 여러개 ai서버도 있고 ~ 이것저것 많아짐
	- 백엔드의 역할을 다양하게 나누어 서로 api 통신하게 만드는 형태 
	- 대부분의 SaaS 
	- **+다양한 실습환경에서 했던 것들을 클라우드 아키텍쳐 만드는 연습**

- 다층 구조의 핵심은 데이터와 비용 설계
	- 비즈니스 상황을 고려하여 티어 선택만 해도 클라우드 아키텍처 설계가 쉬워짐
	- 애플리케이션이 너무 커져서 만약 모듈들을 여러 애플리 케이션으로 쪼갠다면, 보통 쪼개는 기준은 데이터 기반이 가장 보편적이다. (결제 시스템, 유저 시스템)
	- + 마지막 개념에 대해 좀 더 생각해보기

#### 클라우드 아키텍쳐 종류
- 퍼블릭 클라우드 아키텍처 : 최종 사용자가 소유하지 않은 리소스에서 생성되어 다른 테넌트에 재배포될 수 있는 클라우드 환경
- 프라이빗 클라우드 아키텍쳐: 대략적으로 정의하자면 최종 사용자 전용 클라우드 환경으로, 대개는 사용자의 방화벽 내에 있으며 가끔 온 프레미스에 있기도 함
- 하이브리드 클라우드 아키텍쳐: 어느정도의 워크로드 이식성, 오케스트레이션 및 관리 기능을 갖춘 멀티플 클라우드 환경
- 멀티클라우드 아키텍처: 네트워크 연결에 상관 없이 2개 이상의 클라우드를 포함한 it 시스템

다음엔 Shell Script 작성 해보기

