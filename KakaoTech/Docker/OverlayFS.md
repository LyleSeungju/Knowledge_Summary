### OverlayFS
두개의 디렉토리를 레이어로 구성하고, 이를 단일 디렉토리로 보여주는 파일 시스템
- Layer: 디렉토리 - 최대 128개의 하위 OverlayFS 레이어를 네이티브로 지원
- Union: 결합 프로세스
- 구조
	- 통합된 뷰 merged 
	- 상위 디렉토리 upperdir
	- 하위 디렉토리 lowerdir
- 효과 : docker build 및 docker commit 과 같은 레이어 관련 docker 명령어의 성능을 향상시키고, 백업 파일 시스템의 인오드 사용량을 줄임

#### 파일 읽기
- **컨테이너 레이어(upper)에 파일이 없는 경우**: 파일을 읽을 때 컨테이너 레이어에 파일이 없으면, 이미지 레이어에서 읽어옵니다. 성능 오버헤드는 없다
- **컨테이너 레이어에 파일이 있는 경우**: 파일이 컨테이너 레이어에만 존재하면, 해당 파일을 직접 읽습니다.
- **두 레이어(lower, upper) 모두에 파일이 있는 경우**: 컨테이너 레이어에 파일이 우선 읽음.

#### 파일 수정
- **처음 파일 쓰기**: 컨테이너에서 파일에 처음 쓸때, 해당 파일이 이미지 레이어에 있으면 copy_up 작업을 통해 컨테이너 레이어로 복사됩니다. > 이후 컨테이너 레이어에서 처리
- OverlayFS는 파일 수준에서 작동하므로 copy_up 작업은 파일 전체를 복사

#### 파일 및 디렉토리 삭제
- **파일 삭제**: 컨테이너에서 파일을 삭제하면 whiteout 파일이 생성되어, 이미지 레이어의 파일이 컨테이너에서 접근되지 않도록 합니다.
- **디렉토리 삭제**: 디렉토리를 삭제하면 opaque 디렉토리가 생성되어 접근을 차단

#### 성능 최적화
- **페이지 캐싱**: OverlayFS는 페이지 캐시 공유를 지원하여, 여러 컨테이너가 동일한 파일에 접근할 때 단일 페이지 캐시 엔트리를 공유
- **copy_up 작업**: 초기 쓰기 시 copy_up 작업이 발생하여 성능에 영향, 그러나 이후의 모든 쓰기는 상위 레이어에서 처리


**Q. 하나의 레이어가 upper+ lower인가요 아니면 lower, uppder 각각 하나씩?**
- 각각 따로
	- lower = image layer
	- upper = container layer
	- merged = 현재 상태
